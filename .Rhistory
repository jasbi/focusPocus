hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
#separata the question names from their stress number.
#name example: not_and_eb_001, not_and_eb_101. The function below separates the name not_and_eb from the number.
#the number at the end of the name is the stress number. If the first number is zero (001), then "not"is stressed.
#if the first number is 1 (101), then the coordinating conjunction is stressed.
english_experimental_data <- english_experimental_data %>%
separate(question, into = c("not", "conjunction", "animals", "stress_number"),
sep = "_", fill = "right")
english_experimental_data <- english_experimental_data %>%
mutate(not_conjunction = paste(not, conjunction, sep = "_"))
english_experimental_data <- english_experimental_data %>%
select(-not, -conjunction)
hungarian_experimental_data <- hungarian_experimental_data %>%
separate(question, into = c("not", "conjunction", "animals", "stress_number"),
sep = "_", fill = "right")
hungarian_experimental_data <- hungarian_experimental_data %>%
mutate(not_conjunction = paste(not, conjunction, sep = "_"))
hungarian_experimental_data <- hungarian_experimental_data %>%
select(-not, -conjunction)
hungarian2_experimental_data <- hungarian2_experimental_data %>%
separate(question, into = c("not", "conjunction", "animals", "stress_number"),
sep = "_", fill = "right")
hungarian2_experimental_data <- hungarian2_experimental_data %>%
mutate(not_conjunction = paste(not, conjunction, sep = "_"))
hungarian2_experimental_data <- hungarian2_experimental_data %>%
select(-not, -conjunction)
#create question groups by the stress number.
english_experimental_data <- english_experimental_data %>%
mutate(group_combined = case_when(
not_conjunction == "not_or" & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or" & stress_number %in% c(101, 102, 103) ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c(101, 102, 103) ~ "not_AND",
TRUE ~ not_conjunction
))
hungarian_experimental_data <- hungarian_experimental_data %>%
mutate(group_combined = case_when(
not_conjunction == "not_or" & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or" & stress_number %in% c(101, 102, 103) ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c(101, 102, 103) ~ "not_AND",
TRUE ~ not_conjunction
))
hungarian2_experimental_data <- hungarian2_experimental_data %>%
mutate(group_combined = case_when(
not_conjunction == "not_or" & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or" & stress_number %in% c(101, 102, 103) ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c(101, 102, 103) ~ "not_AND",
TRUE ~ not_conjunction
))
write_csv(english_experimental_data, "english_experimental_data.csv")
write_csv(hungarian_experimental_data, "hungarian_experimental_data.csv")
write_csv(hungarian2_experimental_data, "hungarian2_experimental_data.csv")
# Calculate proportions
english_data_summary <- english_experimental_data %>%
group_by(group_combined, response) %>%
summarize(count = n()) %>%
mutate(proportion = count / sum(count))
hungarian_data_summary <- hungarian_experimental_data %>%
group_by(group_combined, response) %>%
summarize(count = n()) %>%
mutate(proportion = count / sum(count))
hungarian2_data_summary <- hungarian2_experimental_data %>%
group_by(group_combined, response) %>%
summarize(count = n()) %>%
mutate(proportion = count / sum(count))
#write the data summary into a csv
write_csv(english_data_summary, "english_data_summary.csv")
write_csv(hungarian_data_summary, "hungarian_data_summary.csv")
write_csv(hungarian2_data_summary, "hungarian2_data_summary.csv")
# define custom colors
custom_colors <- c(
"animal 1, animal 2" = "#808080",        # Medium gray
"animal 1, animal 2, no animal" = "#FFD200",  # UC Davis gold
"animal 1, no animal" = "#94BFA2",       # Cool green
"animal 2" = "#2F4858",                  # Deep slate
"animal 2, no animal" = "#A5C8E1",       # Soft blue
"both animals" = "#F1F1F1",              # Pale gray
"no animal" = "#002855",                # UC Davis blue
"NA" = "#D0D0D0"                         # Light gray
)
# Create the stacked bar plot
ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
# Create the stacked bar plot
ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#creating the plot for the control data
#filter control data from the modified tidy data
english_control_data <- english_modified_tidy_data %>%
filter(grepl("^Control", question))
english_control_data <- english_control_data %>%
separate(question, into = c("control", "name", "number"),
sep = "_", fill = "right")
hungarian_control_data <- hungarian_modified_tidy_data %>%
filter(grepl("^Control", question))
hungarian_control_data <- hungarian_control_data %>%
separate(question, into = c("control", "name", "number"),
sep = "_", fill = "right")
hungarian2_control_data <- hungarian2_modified_tidy_data %>%
filter(grepl("^Control", question))
hungarian2_control_data <- hungarian2_control_data %>%
separate(question, into = c("control", "name", "number"),
sep = "_", fill = "right")
#Create the stacked bar plot for the control data
english_control_plot <- english_control_data %>%
group_by(name, response) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(proportion = count / sum(count)) %>%
ggplot(aes(x = name, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Control Questions",
x = "Question",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
hungarian_control_plot <- hungarian_control_data %>%
group_by(name, response) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(proportion = count / sum(count)) %>%
ggplot(aes(x = name, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Control Questions",
x = "Question",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
hungarian2_control_plot <- hungarian2_control_data %>%
group_by(name, response) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(proportion = count / sum(count)) %>%
ggplot(aes(x = name, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Control Questions",
x = "Question",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
print(english_control_plot)
print(hungarian2_control_plot)
print(hungarian_control_plot)
library(ggplot2)
library(dplyr)
# Define a consistent theme for all plots
pretty_theme <- theme_minimal(base_size = 16) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 14),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 16, face = "bold"),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "gray85"),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
# Define your refined color palette
custom_colors <- c(
"animal 1, animal 2" = "#808080",
"animal 1, animal 2, no animal" = "#FFD200",
"animal 1, no animal" = "#94BFA2",
"animal 2" = "#2F4858",
"animal 2, no animal" = "#A5C8E1",
"both animals" = "#F1F1F1",
"no animal" = "#002855",
"NA" = "#D0D0D0"
)
# Define a function to make the plots pretty and reusable
make_pretty_plot <- function(data, title) {
ggplot(data, aes(x = group_combined, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", width = 0.7) +
scale_fill_manual(values = custom_colors) +
labs(
x = "Stress Condition",
y = "Proportion of Responses",
fill = "Response Type",
title = title
) +
pretty_theme
}
# Now generate all three
english_plot <- make_pretty_plot(english_data_summary, "English")
hungarian_plot <- make_pretty_plot(hungarian_data_summary, "Hungarian 1")
hungarian2_plot <- make_pretty_plot(hungarian2_data_summary, "Hungarian 2")
# Print them (you can also use patchwork or gridExtra to combine if needed)
print(english_plot)
print(hungarian_plot)
print(hungarian2_plot)
library(ggplot2)
library(dplyr)
# Define a consistent theme for all plots
pretty_theme <- theme_minimal(base_size = 16) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 14),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 16, face = "bold"),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "gray85"),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
# Define your refined color palette
custom_colors <- c(
"animal 1, animal 2" = "#F6A623",       # golden poppy orange
"animal 1, animal 2, no animal" = "#FFD76D",  # light golden yellow
"animal 1, no animal" = "#D78E04",      # deep orange
"animal 2" = "#A65628",                # burnt sienna / earthy red
"animal 2, no animal" = "#D9A86C",     # desert sand
"both animals" = "#FBEEC1",            # poppy petal cream
"no animal" = "#6B8E23",               # olive green
"NA" = "#CFCFC4"                       # warm neutral
)
# Define a function to make the plots pretty and reusable
make_pretty_plot <- function(data, title) {
ggplot(data, aes(x = group_combined, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", width = 0.7) +
scale_fill_manual(values = custom_colors) +
labs(
x = "Stress Condition",
y = "Proportion of Responses",
fill = "Response Type",
title = title
) +
pretty_theme
}
# Now generate all three
english_plot <- make_pretty_plot(english_data_summary, "English")
hungarian_plot <- make_pretty_plot(hungarian_data_summary, "Hungarian 1")
hungarian2_plot <- make_pretty_plot(hungarian2_data_summary, "Hungarian 2")
# Print them (you can also use patchwork or gridExtra to combine if needed)
print(english_plot)
print(hungarian_plot)
print(hungarian2_plot)
ggplot(data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = poppy_colors) +
facet_wrap(~group_combined) +
theme_minimal()
ggplot(data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
facet_wrap(~group_combined) +
theme_minimal()
ggplot(data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
facet_wrap(~group_combined) +
theme_minimal()
ggplot(data_summary, aes(x = response, y = group_combined, fill = proportion)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#fff7ec", high = "#f16913") + # warm poppy tones
labs(x = "Response", y = "Group", fill = "Proportion") +
theme_minimal()
# Single group pie
library(ggpubr)
# Single group pie
install.packages("ggpubr")
library(ggpubr)
ggpie(data_summary %>% filter(group_combined == "NOT_or"),
x = "proportion", label = "response", fill = "response",
palette = poppy_colors)
# Single group pie
install.packages("ggpubr")
library(ggpubr)
ggpie(data_summary %>% filter(group_combined == "NOT_or"),
x = "proportion", label = "response", fill = "response",
palette = poppy_colors)
install.packages("ggpubr")
# Single group pie
library(ggpubr)
ggpie(data_summary %>% filter(group_combined == "NOT_or"),
x = "proportion", label = "response", fill = "response",
palette = poppy_colors)
# Single group pie
library(ggpubr)
ggpie(data_summary %>% filter(group_combined == "NOT_or"),
x = "proportion", label = "response", fill = "response",
palette = custom_colors)
# Single group pie
ggplot(data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
facet_wrap(~group_combined) +
theme_minimal()
# Single group pie
ggplot(english_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = poppy_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",  # optional: remove if redundant
strip.text = element_text(face = "bold")
)
# Single group pie
ggplot(english_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",  # optional: remove if redundant
strip.text = element_text(face = "bold")
)
# Single group pie
ggplot(english_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = poppy_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
# Single group pie
ggplot(english_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
# Single group pie
ggplot(hungarian_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
# Single group pie
ggplot(hungarian_data_summary2, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
# Single group pie
ggplot(hungarian2_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
# Single group pie
ggplot(hungarian_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
View(hungarian_data_summary)
View(hungarian2_data_summary)
# Single group pie
ggplot(hungarian2_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
english_fit
hungarian_fit
hungarian2_fit
