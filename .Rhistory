write_csv(hungarian_data_summary, "hungarian_data_summary.csv")
write_csv(hungarian2_data_summary, "hungarian2_data_summary.csv")
# define custom colors
custom_colors <- c(
"animal 1, animal 2" = "#808080",        # Medium gray
"animal 1, animal 2, no animal" = "#FFD200",  # UC Davis gold
"animal 1, no animal" = "#94BFA2",       # Cool green
"animal 2" = "#2F4858",                  # Deep slate
"animal 2, no animal" = "#A5C8E1",       # Soft blue
"both animals" = "#F1F1F1",              # Pale gray
"no animal" = "#002855",                # UC Davis blue
"NA" = "#D0D0D0"                         # Light gray
)
# Create the stacked bar plot
ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
# Create the stacked bar plot
ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(tidyverse)
# --------------------------------------------------
# 1. Load data
# --------------------------------------------------
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
# --------------------------------------------------
# 2. Remove Control questions
# --------------------------------------------------
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
# --------------------------------------------------
# 3. Separate question components + create group labels
# --------------------------------------------------
clean_data <- function(df) {
df %>%
separate(question,
into = c("not", "conj", "animals", "stress_number"),
sep = "_", fill = "right") %>%
mutate(not_conjunction = paste(not, conj, sep = "_")) %>%
select(-not, -conj) %>%
mutate(group_combined = case_when(
not_conjunction == "not_or"  & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or"  & stress_number %in% c("101", "102", "103") ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c("101", "102", "103") ~ "not_AND",
TRUE ~ not_conjunction
))
}
english_experimental_data  <- clean_data(english_experimental_data)
hungarian_experimental_data <- clean_data(hungarian_experimental_data)
hungarian2_experimental_data <- clean_data(hungarian2_experimental_data)
# --------------------------------------------------
# 4. Recode responses → NOR / NAND / Other
# --------------------------------------------------
recode_responses <- function(df) {
df %>%
mutate(response_simple = case_when(
response == "animal 1, animal 2, no animal" ~ "NAND",
response == "no animal" ~ "NOR",
TRUE ~ "Other"
))
}
english_experimental_data  <- recode_responses(english_experimental_data)
hungarian_experimental_data <- recode_responses(hungarian_experimental_data)
hungarian2_experimental_data <- recode_responses(hungarian2_experimental_data)
# --------------------------------------------------
# 5. Summaries
# --------------------------------------------------
summarize_data <- function(df) {
df %>%
group_by(group_combined, response_simple) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
}
english_summary  <- summarize_data(english_experimental_data)
hungarian_summary <- summarize_data(hungarian_experimental_data)
hungarian2_summary <- summarize_data(hungarian2_experimental_data)
# --------------------------------------------------
# 6. Colors for the three categories
# --------------------------------------------------
simple_colors <- c(
"NOR"  = "#FFD200",  # gold
"NAND" = "#002855",  # dark blue
"Other" = "#808080"  # grey
)
# --------------------------------------------------
# 7. Plot function
# --------------------------------------------------
plot_simple <- function(df) {
ggplot(df, aes(x = group_combined, y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# --------------------------------------------------
# 8. Create the three plots
# --------------------------------------------------
plot_simple(english_summary)
plot_simple(hungarian_summary)
plot_simple(hungarian2_summary)
english_summary  <- english_summary  %>% mutate(language = "English/Experiment 1")
hungarian_summary <- hungarian_summary %>% mutate(language = "Hungarian 1")
hungarian2_summary <- hungarian2_summary %>% mutate(language = "Hungarian 2")
all_summary <- bind_rows(english_summary, hungarian_summary, hungarian2_summary)
ggplot(all_summary, aes(x = group_combined,
y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
facet_wrap(~ language, nrow = 1) +   # <<--- top labels
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(
strip.text = element_text(size = 14, face = "bold"),  # top label style
axis.text.x = element_text(angle = 45, hjust = 1)
)
library(tidyverse)
# --------------------------------------------------
# 1. Load data
# --------------------------------------------------
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
# --------------------------------------------------
# 2. Remove Control questions
# --------------------------------------------------
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
# --------------------------------------------------
# 3. Separate question components + create group labels
# --------------------------------------------------
clean_data <- function(df) {
df %>%
separate(question,
into = c("not", "conj", "animals", "stress_number"),
sep = "_", fill = "right") %>%
mutate(not_conjunction = paste(not, conj, sep = "_")) %>%
select(-not, -conj) %>%
mutate(group_combined = case_when(
not_conjunction == "not_or"  & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or"  & stress_number %in% c("101", "102", "103") ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c("101", "102", "103") ~ "not_AND",
TRUE ~ not_conjunction
))
}
english_experimental_data  <- clean_data(english_experimental_data)
hungarian_experimental_data <- clean_data(hungarian_experimental_data)
hungarian2_experimental_data <- clean_data(hungarian2_experimental_data)
# --------------------------------------------------
# 4. Recode responses → NOR / NAND / Other
# --------------------------------------------------
recode_responses <- function(df) {
df %>%
mutate(response_simple = case_when(
response == "animal 1, animal 2, no animal" ~ "NAND",
response == "no animal" ~ "NOR",
TRUE ~ "Other"
))
}
english_experimental_data  <- recode_responses(english_experimental_data)
hungarian_experimental_data <- recode_responses(hungarian_experimental_data)
hungarian2_experimental_data <- recode_responses(hungarian2_experimental_data)
# --------------------------------------------------
# 5. Summaries
# --------------------------------------------------
summarize_data <- function(df) {
df %>%
group_by(group_combined, response_simple) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
}
english_summary  <- summarize_data(english_experimental_data)
hungarian_summary <- summarize_data(hungarian_experimental_data)
hungarian2_summary <- summarize_data(hungarian2_experimental_data)
# --------------------------------------------------
# 6. Colors for the three categories
# --------------------------------------------------
simple_colors <- c(
"NOR"  = "#FFD200",  # gold
"NAND" = "#002855",  # dark blue
"Other" = "#808080"  # grey
)
# --------------------------------------------------
# 7. Plot function
# --------------------------------------------------
plot_simple <- function(df) {
ggplot(df, aes(x = group_combined, y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# --------------------------------------------------
# 8. Create the three plots
# --------------------------------------------------
plot_simple(english_summary)
plot_simple(hungarian_summary)
plot_simple(hungarian2_summary)
english_summary  <- english_summary  %>% mutate(language = "English\Experiment 1")
library(tidyverse)
# --------------------------------------------------
# 1. Load data
# --------------------------------------------------
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
# --------------------------------------------------
# 2. Remove Control questions
# --------------------------------------------------
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
# --------------------------------------------------
# 3. Separate question components + create group labels
# --------------------------------------------------
clean_data <- function(df) {
df %>%
separate(question,
into = c("not", "conj", "animals", "stress_number"),
sep = "_", fill = "right") %>%
mutate(not_conjunction = paste(not, conj, sep = "_")) %>%
select(-not, -conj) %>%
mutate(group_combined = case_when(
not_conjunction == "not_or"  & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or"  & stress_number %in% c("101", "102", "103") ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c("101", "102", "103") ~ "not_AND",
TRUE ~ not_conjunction
))
}
english_experimental_data  <- clean_data(english_experimental_data)
hungarian_experimental_data <- clean_data(hungarian_experimental_data)
hungarian2_experimental_data <- clean_data(hungarian2_experimental_data)
# --------------------------------------------------
# 4. Recode responses → NOR / NAND / Other
# --------------------------------------------------
recode_responses <- function(df) {
df %>%
mutate(response_simple = case_when(
response == "animal 1, animal 2, no animal" ~ "NAND",
response == "no animal" ~ "NOR",
TRUE ~ "Other"
))
}
english_experimental_data  <- recode_responses(english_experimental_data)
hungarian_experimental_data <- recode_responses(hungarian_experimental_data)
hungarian2_experimental_data <- recode_responses(hungarian2_experimental_data)
# --------------------------------------------------
# 5. Summaries
# --------------------------------------------------
summarize_data <- function(df) {
df %>%
group_by(group_combined, response_simple) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
}
english_summary  <- summarize_data(english_experimental_data)
hungarian_summary <- summarize_data(hungarian_experimental_data)
hungarian2_summary <- summarize_data(hungarian2_experimental_data)
# --------------------------------------------------
# 6. Colors for the three categories
# --------------------------------------------------
simple_colors <- c(
"NOR"  = "#FFD200",  # gold
"NAND" = "#002855",  # dark blue
"Other" = "#808080"  # grey
)
# --------------------------------------------------
# 7. Plot function
# --------------------------------------------------
plot_simple <- function(df) {
ggplot(df, aes(x = group_combined, y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# --------------------------------------------------
# 8. Create the three plots
# --------------------------------------------------
plot_simple(english_summary)
plot_simple(hungarian_summary)
plot_simple(hungarian2_summary)
english_summary  <- english_summary  %>% mutate(language = "English\nExperiment 1")
hungarian_summary <- hungarian_summary %>% mutate(language = "Hungarian 1")
hungarian2_summary <- hungarian2_summary %>% mutate(language = "Hungarian 2")
all_summary <- bind_rows(english_summary, hungarian_summary, hungarian2_summary)
ggplot(all_summary, aes(x = group_combined,
y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
facet_wrap(~ language, nrow = 1) +   # <<--- top labels
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(
strip.text = element_text(size = 14, face = "bold"),  # top label style
axis.text.x = element_text(angle = 45, hjust = 1)
)
library(tidyverse)
# --------------------------------------------------
# 1. Load data
# --------------------------------------------------
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
# --------------------------------------------------
# 2. Remove Control questions
# --------------------------------------------------
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
# --------------------------------------------------
# 3. Separate question components + create group labels
# --------------------------------------------------
clean_data <- function(df) {
df %>%
separate(question,
into = c("not", "conj", "animals", "stress_number"),
sep = "_", fill = "right") %>%
mutate(not_conjunction = paste(not, conj, sep = "_")) %>%
select(-not, -conj) %>%
mutate(group_combined = case_when(
not_conjunction == "not_or"  & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or"  & stress_number %in% c("101", "102", "103") ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c("101", "102", "103") ~ "not_AND",
TRUE ~ not_conjunction
))
}
english_experimental_data  <- clean_data(english_experimental_data)
hungarian_experimental_data <- clean_data(hungarian_experimental_data)
hungarian2_experimental_data <- clean_data(hungarian2_experimental_data)
# --------------------------------------------------
# 4. Recode responses → NOR / NAND / Other
# --------------------------------------------------
recode_responses <- function(df) {
df %>%
mutate(response_simple = case_when(
response == "animal 1, animal 2, no animal" ~ "NAND",
response == "no animal" ~ "NOR",
TRUE ~ "Other"
))
}
english_experimental_data  <- recode_responses(english_experimental_data)
hungarian_experimental_data <- recode_responses(hungarian_experimental_data)
hungarian2_experimental_data <- recode_responses(hungarian2_experimental_data)
# --------------------------------------------------
# 5. Summaries
# --------------------------------------------------
summarize_data <- function(df) {
df %>%
group_by(group_combined, response_simple) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
}
english_summary  <- summarize_data(english_experimental_data)
hungarian_summary <- summarize_data(hungarian_experimental_data)
hungarian2_summary <- summarize_data(hungarian2_experimental_data)
# --------------------------------------------------
# 6. Colors for the three categories
# --------------------------------------------------
simple_colors <- c(
"NOR"  = "#FFD200",  # gold
"NAND" = "#002855",  # dark blue
"Other" = "#808080"  # grey
)
# --------------------------------------------------
# 7. Plot function
# --------------------------------------------------
plot_simple <- function(df) {
ggplot(df, aes(x = group_combined, y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# --------------------------------------------------
# 8. Create the three plots
# --------------------------------------------------
plot_simple(english_summary)
plot_simple(hungarian_summary)
plot_simple(hungarian2_summary)
english_summary  <- english_summary  %>% mutate(language = "English\nExperiment 1")
hungarian_summary <- hungarian_summary %>% mutate(language = "Hungarian 1\nExperinemt 2")
hungarian2_summary <- hungarian2_summary %>% mutate(language = "Hungarian 2\nExperiment 3")
all_summary <- bind_rows(english_summary, hungarian_summary, hungarian2_summary)
ggplot(all_summary, aes(x = group_combined,
y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
facet_wrap(~ language, nrow = 1) +   # <<--- top labels
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(
strip.text = element_text(size = 14, face = "bold"),  # top label style
axis.text.x = element_text(angle = 45, hjust = 1)
)
