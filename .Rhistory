#create question groups by the stress number.
english_experimental_data <- english_experimental_data %>%
mutate(group_combined = case_when(
not_conjunction == "not_or" & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or" & stress_number %in% c(101, 102, 103) ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c(101, 102, 103) ~ "not_AND",
TRUE ~ not_conjunction
))
hungarian_experimental_data <- hungarian_experimental_data %>%
mutate(group_combined = case_when(
not_conjunction == "not_or" & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or" & stress_number %in% c(101, 102, 103) ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c(101, 102, 103) ~ "not_AND",
TRUE ~ not_conjunction
))
hungarian2_experimental_data <- hungarian2_experimental_data %>%
mutate(group_combined = case_when(
not_conjunction == "not_or" & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or" & stress_number %in% c(101, 102, 103) ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c(101, 102, 103) ~ "not_AND",
TRUE ~ not_conjunction
))
write_csv(english_experimental_data, "english_experimental_data.csv")
write_csv(hungarian_experimental_data, "hungarian_experimental_data.csv")
write_csv(hungarian2_experimental_data, "hungarian2_experimental_data.csv")
# Calculate proportions
english_data_summary <- english_experimental_data %>%
group_by(group_combined, response) %>%
summarize(count = n()) %>%
mutate(proportion = count / sum(count))
hungarian_data_summary <- hungarian_experimental_data %>%
group_by(group_combined, response) %>%
summarize(count = n()) %>%
mutate(proportion = count / sum(count))
hungarian2_data_summary <- hungarian2_experimental_data %>%
group_by(group_combined, response) %>%
summarize(count = n()) %>%
mutate(proportion = count / sum(count))
#write the data summary into a csv
write_csv(english_data_summary, "english_data_summary.csv")
write_csv(hungarian_data_summary, "hungarian_data_summary.csv")
write_csv(hungarian2_data_summary, "hungarian2_data_summary.csv")
# define custom colors
custom_colors <- c(
"animal 1, animal 2" = "#808080",        # Medium gray
"animal 1, animal 2, no animal" = "#FFD200",  # UC Davis gold
"animal 1, no animal" = "#94BFA2",       # Cool green
"animal 2" = "#2F4858",                  # Deep slate
"animal 2, no animal" = "#A5C8E1",       # Soft blue
"both animals" = "#F1F1F1",              # Pale gray
"no animal" = "#002855",                # UC Davis blue
"NA" = "#D0D0D0"                         # Light gray
)
# Create the stacked bar plot
ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
# Create the stacked bar plot
ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)
# Define a consistent theme for all plots
pretty_theme <- theme_minimal(base_size = 16) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 14),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 16, face = "bold"),
legend.position = "right",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "gray85"),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
# Define your refined color palette
custom_colors <- c(
"animal 1, animal 2" = "#F6A623",       # golden poppy orange
"animal 1, animal 2, no animal" = "#FFD76D",  # light golden yellow
"animal 1, no animal" = "#D78E04",      # deep orange
"animal 2" = "#A65628",                # burnt sienna / earthy red
"animal 2, no animal" = "#D9A86C",     # desert sand
"both animals" = "#FBEEC1",            # poppy petal cream
"no animal" = "#6B8E23",               # olive green
"NA" = "#CFCFC4"                       # warm neutral
)
# Define a function to make the plots pretty and reusable
make_pretty_plot <- function(data, title) {
ggplot(data, aes(x = group_combined, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", width = 0.7) +
scale_fill_manual(values = custom_colors) +
labs(
x = "Stress Condition",
y = "Proportion of Responses",
fill = "Response Type",
title = title
) +
pretty_theme
}
# Now generate all three
english_plot <- make_pretty_plot(english_data_summary, "English")
hungarian_plot <- make_pretty_plot(hungarian_data_summary, "Hungarian 1")
hungarian2_plot <- make_pretty_plot(hungarian2_data_summary, "Hungarian 2")
# Print them (you can also use patchwork or gridExtra to combine if needed)
print(english_plot)
print(hungarian_plot)
print(hungarian2_plot)
# Single group pie
ggplot(hungarian2_data_summary, aes(x = response, y = proportion, fill = response)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(proportion, 2)),
hjust = -0.1,  # shift text slightly outside the bar
size = 3.5) +
facet_wrap(~ group_combined) +
coord_flip() +
scale_fill_manual(values = custom_colors) +
labs(x = "Response", y = "Proportion") +
theme_minimal() +
theme(
legend.position = "none",
strip.text = element_text(face = "bold")
) +
expand_limits(y = 1.05)  # ensure space for the labels
library(patchwork)
p_eng <- ggplot(english_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(title = "English",
x = "Question Group",
y = "Proportion") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p_hun <- ggplot(hungarian_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(title = "Hungarian (Set 1)",
x = "Question Group",
y = "Proportion") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p_hun2 <- ggplot(hungarian2_data_summary, aes(x = group_combined,
y = proportion,
fill = as.factor(response))) +
geom_bar(stat = "identity") +
labs(title = "Hungarian (Set 2)",
x = "Question Group",
y = "Proportion") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Combine all plots into one figure
combined <- p_eng | p_hun | p_hun2
combined
#creating the plot for the control data
#filter control data from the modified tidy data
english_control_data <- english_modified_tidy_data %>%
filter(grepl("^Control", question))
english_control_data <- english_control_data %>%
separate(question, into = c("control", "name", "number"),
sep = "_", fill = "right")
hungarian_control_data <- hungarian_modified_tidy_data %>%
filter(grepl("^Control", question))
hungarian_control_data <- hungarian_control_data %>%
separate(question, into = c("control", "name", "number"),
sep = "_", fill = "right")
hungarian2_control_data <- hungarian2_modified_tidy_data %>%
filter(grepl("^Control", question))
hungarian2_control_data <- hungarian2_control_data %>%
separate(question, into = c("control", "name", "number"),
sep = "_", fill = "right")
#Create the stacked bar plot for the control data
english_control_plot <- english_control_data %>%
group_by(name, response) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(proportion = count / sum(count)) %>%
ggplot(aes(x = name, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Control Questions",
x = "Question",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
hungarian_control_plot <- hungarian_control_data %>%
group_by(name, response) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(proportion = count / sum(count)) %>%
ggplot(aes(x = name, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Control Questions",
x = "Question",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
hungarian2_control_plot <- hungarian2_control_data %>%
group_by(name, response) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(proportion = count / sum(count)) %>%
ggplot(aes(x = name, y = proportion, fill = as.factor(response))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Control Questions",
x = "Question",
y = "Proportion of Responses",
fill = "Response") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
print(english_control_plot)
print(hungarian2_control_plot)
print(hungarian_control_plot)
# Read the data
english_df <- read.csv("english_experimental_data.csv")
hungarian_df <- read.csv("hungarian_experimental_data.csv")
hungarian2_df <- read.csv("hungarian2_experimental_data.csv")
# Convert response to factor (required for categorical family)
english_df$response <- as.factor(english_df$response)
english_fit <- brm(
formula = response ~ group_combined,
family = categorical(),
data = english_df
)
#extracting the data without the "control" suffix
#Load experimental data from the modified tidy data.
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
#extracting the data without the "control" suffix
#Load experimental data from the modified tidy data.
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
library(tidyverse)
# --------------------------------------------------
# 1. Load data
# --------------------------------------------------
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
# --------------------------------------------------
# 2. Remove Control questions
# --------------------------------------------------
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
# --------------------------------------------------
# 3. Separate question components + create group labels
# --------------------------------------------------
clean_data <- function(df) {
df %>%
separate(question,
into = c("not", "conj", "animals", "stress_number"),
sep = "_", fill = "right") %>%
mutate(not_conjunction = paste(not, conj, sep = "_")) %>%
select(-not, -conj) %>%
mutate(group_combined = case_when(
not_conjunction == "not_or"  & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or"  & stress_number %in% c("101", "102", "103") ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c("101", "102", "103") ~ "not_AND",
TRUE ~ not_conjunction
))
}
english_experimental_data  <- clean_data(english_experimental_data)
hungarian_experimental_data <- clean_data(hungarian_experimental_data)
hungarian2_experimental_data <- clean_data(hungarian2_experimental_data)
# --------------------------------------------------
# 4. Recode responses → NOR / NAND / Other
# --------------------------------------------------
recode_responses <- function(df) {
df %>%
mutate(response_simple = case_when(
response == "animal 1, animal 2, no animal" ~ "NOR",
response == "no animal" ~ "NAND",
TRUE ~ "Other"
))
}
english_experimental_data  <- recode_responses(english_experimental_data)
hungarian_experimental_data <- recode_responses(hungarian_experimental_data)
hungarian2_experimental_data <- recode_responses(hungarian2_experimental_data)
# --------------------------------------------------
# 5. Summaries
# --------------------------------------------------
summarize_data <- function(df) {
df %>%
group_by(group_combined, response_simple) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
}
english_summary  <- summarize_data(english_experimental_data)
hungarian_summary <- summarize_data(hungarian_experimental_data)
hungarian2_summary <- summarize_data(hungarian2_experimental_data)
# --------------------------------------------------
# 6. Colors for the three categories
# --------------------------------------------------
simple_colors <- c(
"NOR"  = "#FFD200",  # gold
"NAND" = "#002855",  # dark blue
"Other" = "#808080"  # grey
)
# --------------------------------------------------
# 7. Plot function
# --------------------------------------------------
plot_simple <- function(df) {
ggplot(df, aes(x = group_combined, y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# --------------------------------------------------
# 8. Create the three plots
# --------------------------------------------------
plot_simple(english_summary)
plot_simple(hungarian_summary)
plot_simple(hungarian2_summary)
library(tidyverse)
# --------------------------------------------------
# 1. Load data
# --------------------------------------------------
english_modified_tidy_data <- read.csv("english_tidydata_modified.csv")
hungarian_modified_tidy_data <- read.csv("hungarian_tidydata_modified.csv")
hungarian2_modified_tidy_data <- read.csv("hungarian2_tidydata_modified.csv")
# --------------------------------------------------
# 2. Remove Control questions
# --------------------------------------------------
english_experimental_data <- english_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian_experimental_data <- hungarian_modified_tidy_data %>%
filter(!grepl("^Control", question))
hungarian2_experimental_data <- hungarian2_modified_tidy_data %>%
filter(!grepl("^Control", question))
# --------------------------------------------------
# 3. Separate question components + create group labels
# --------------------------------------------------
clean_data <- function(df) {
df %>%
separate(question,
into = c("not", "conj", "animals", "stress_number"),
sep = "_", fill = "right") %>%
mutate(not_conjunction = paste(not, conj, sep = "_")) %>%
select(-not, -conj) %>%
mutate(group_combined = case_when(
not_conjunction == "not_or"  & stress_number %in% c("001", "002", "003") ~ "NOT_or",
not_conjunction == "not_or"  & stress_number %in% c("101", "102", "103") ~ "not_OR",
not_conjunction == "not_and" & stress_number %in% c("001", "002", "003") ~ "NOT_and",
not_conjunction == "not_and" & stress_number %in% c("101", "102", "103") ~ "not_AND",
TRUE ~ not_conjunction
))
}
english_experimental_data  <- clean_data(english_experimental_data)
hungarian_experimental_data <- clean_data(hungarian_experimental_data)
hungarian2_experimental_data <- clean_data(hungarian2_experimental_data)
# --------------------------------------------------
# 4. Recode responses → NOR / NAND / Other
# --------------------------------------------------
recode_responses <- function(df) {
df %>%
mutate(response_simple = case_when(
response == "animal 1, animal 2, no animal" ~ "NOR",
response == "no animal" ~ "NAND",
TRUE ~ "Other"
))
}
english_experimental_data  <- recode_responses(english_experimental_data)
hungarian_experimental_data <- recode_responses(hungarian_experimental_data)
hungarian2_experimental_data <- recode_responses(hungarian2_experimental_data)
# --------------------------------------------------
# 5. Summaries
# --------------------------------------------------
summarize_data <- function(df) {
df %>%
group_by(group_combined, response_simple) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
}
english_summary  <- summarize_data(english_experimental_data)
hungarian_summary <- summarize_data(hungarian_experimental_data)
hungarian2_summary <- summarize_data(hungarian2_experimental_data)
# --------------------------------------------------
# 6. Colors for the three categories
# --------------------------------------------------
simple_colors <- c(
"NOR"  = "#FFD200",  # gold
"NAND" = "#002855",  # dark blue
"Other" = "#808080"  # grey
)
# --------------------------------------------------
# 7. Plot function
# --------------------------------------------------
plot_simple <- function(df) {
ggplot(df, aes(x = group_combined, y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion of Responses",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# --------------------------------------------------
# 8. Create the three plots
# --------------------------------------------------
plot_simple(english_summary)
plot_simple(hungarian_summary)
plot_simple(hungarian2_summary)
english_summary  <- english_summary  %>% mutate(language = "English")
hungarian_summary <- hungarian_summary %>% mutate(language = "Hungarian 1")
hungarian2_summary <- hungarian2_summary %>% mutate(language = "Hungarian 2")
all_summary <- bind_rows(english_summary, hungarian_summary, hungarian2_summary)
ggplot(all_summary, aes(x = group_combined,
y = proportion,
fill = response_simple)) +
geom_bar(stat = "identity") +
facet_wrap(~ language, nrow = 1) +   # <<--- top labels
scale_fill_manual(values = simple_colors) +
labs(x = "Question Group",
y = "Proportion",
fill = "Response Type") +
theme_bw(base_size = 14) +
theme(
strip.text = element_text(size = 14, face = "bold"),  # top label style
axis.text.x = element_text(angle = 45, hjust = 1)
)
